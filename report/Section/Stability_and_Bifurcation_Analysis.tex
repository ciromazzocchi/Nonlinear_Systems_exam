\section{Stability and Bifurcation analysis}
Analysis of system can be divided in two section:
\begin{itemize}
    \item $R_0 < 1$
    \item $R_0 > 1$
\end{itemize}

\input{Proofs/Equilibrum_Point}

First of all, willbe usefull calculate Jacobian matrix of system \ref{eq:sir_model_3}.

\begin{equation}
    J = 
    \begin{pmatrix}
        \frac{\partial \dot{x_s}}{\partial x_s} & \frac{\partial \dot{x_s}}{\partial x_i} \\
        \frac{\partial \dot{x_i}}{\partial x_s} & \frac{\partial \dot{x_i}}{\partial x_i}
    \end{pmatrix} =
    \begin{pmatrix}
        -\mu-\beta x_i & \beta x_s \\ \beta x_i & \beta x_s -(\gamma + \mu)
    \end{pmatrix}
\end{equation}

Eigenvalues of generic point $(x_s,x_i)$ are

\begin{equation}
    \label{eq:eigenvalues}
    \lambda = 
    \begin{vmatrix}
        \lambda + \mu + \beta x_i & \beta x_s \\
        -\beta x_i & \lambda - \beta x_s  (\gamma + \mu)
    \end{vmatrix}
    = (\lambda + \mu + \beta x_i)(\lambda - \beta x_s + \gamma + \mu ) + \beta^2 x_s x_i
\end{equation}

In not endemic equilibrium point eigenvalues are

\begin{equation}
    \label{eq:eigenvalues_ne}
    (\lambda + \mu)(\lambda - \beta + \gamma + \mu) = 0 \implies \lambda_1 = - \mu, \lambda_2 = \beta-\gamma-\mu
\end{equation}

While, in endemic equilibrium point eigenvalues are

\begin{equation}
    \label{eq:eigenvalues_e}
    \lambda^2+\lambda\left(\frac{\beta\mu}{\gamma + \mu}\right)+\mu(\beta-\gamma-\mu) = 0 \implies \lambda_{1,2} = -\frac{\beta\mu}{2(\gamma + \mu)} \pm \frac{1}{2}\sqrt{\left(\frac{\beta\mu}{\gamma + \mu}\right)^2-4\mu(\beta-\gamma-\mu)}
\end{equation}

First of continue, will be usefull calculates divergence of system \ref{eq:sir_model_3}.

\begin{equation}
\label{eq:divergence}
    \nabla\bullet f = \frac{\partial f_1}{dx_s} + \frac{\partial f_2}{dx_i}=-\mu+\beta (x_s - x_i) -(\gamma + \mu)=\beta\left[(x_s - x_i) - \left(\frac{\mu}{\beta} + \frac{1}{R_0}\right)\right]
\end{equation}

\subsection{Analysis for $R_0 < 1$}
\subsubsection{Existence of equilibria}
\input{Proofs/R0_minor_then_1_Equilibria}
\subsubsection{Existence of limit cycle}
\input{Proofs/R0_minor_then_1_Limit_cycle}

\begin{figure}[h!]
    \centering
    \includegraphics[scale=0.45]{Figure/pp_R0_minor_1.png}
    \caption{Phase Plane of SIR model with $R_0 < 1$ and parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma=0.3$}
    \label{fig:phase_plane_r0_minor_1}
\end{figure}

\subsubsection{Stability analysis}
\input{Proofs/R0_minor_then_1_Stability}
\begin{figure}[h!]
    \centering
    \label{fig:lyapunov_r0_minor_1}
    \begin{subfigure}{\textwidth}
        \centering
        % include first image
        \includegraphics[width=\linewidth]{Figure/lyapunov_2d_R0_minor_1.png}  
        \caption{V in 2D}
        \label{fig:lyapunov_r0_minor_1_first}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Figure/lyapunov_3d_R0_minor_1.png}  
        \caption{V in 3D}
        \label{fig:lyapunov_r0_minor_1_second}
    \end{subfigure}
    \caption{V with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = 0.3$, $P = 0.1$}
\end{figure}

\begin{figure}[h!]
    \centering
    \label{fig:lyapunov_derivative_r0_minor_1}
    \begin{subfigure}{\textwidth}
        \centering
        % include first image
        \includegraphics[width=\linewidth]{Figure/lyapunov_derivative_2d_R0_minor_1.png}  
        \caption{$\dot{V}$ in 2D}
        \label{fig:lyapunov_derivative_r0_minor_1_first}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Figure/lyapunov_derivative_3d_R0_minor_1.png}  
        \caption{$\dot{V}$ in 3D}
        \label{fig:lyapunov_derivative_r0_minor_1_second}
    \end{subfigure}
    \caption{$\dot{V}$ with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = 0.3$, $P = 0.1$}
\end{figure}

\break
\subsection{Analysis for $R_0 > 1$}
\subsubsection{Existence of equilibria}
\input{Proofs/R0_major_then_1_Equilibria}
\subsubsection{Existence of limit cycle}
\input{Proofs/R0_major_then_1_Limit_cycle}

\begin{figure}[h!]
    \centering
    \includegraphics[scale=0.45]{Figure/pp_R0_major_1.png}
    \caption{Phase Plane of SIR model with $R_0 > 1$ and parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma=\frac{1}{14}$}
    \label{fig:phase_plane_r0_major_1}
\end{figure}

\subsubsection{Stability analysis}
\input{Proofs/R0_major_then_1_Stability}

\begin{figure}[h!]
    \centering
    \label{fig:lyapunov_r0_major_1}
    \begin{subfigure}{\textwidth}
        \centering
        % include first image
        \includegraphics[width=\linewidth]{Figure/lyapunov_2d_R0_major_1.png}  
        \caption{V in 2D}
        \label{fig:lyapunov_r0_major_1_first}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Figure/lyapunov_3d_R0_major_1.png}  
        \caption{V in 3D}
        \label{fig:lyapunov_r0_major_1_second}
    \end{subfigure}
    \caption{V with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = \frac{1}{14}$, $P = 1$}
\end{figure}

\begin{figure}[h!]
    \centering
    \label{fig:lyapunov_derivative_r0_major_1}
    \begin{subfigure}{\textwidth}
        \centering
        % include first image
        \includegraphics[width=\linewidth]{Figure/lyapunov_derivative_2d_R0_major_1.png}  
        \caption{$\dot{V}$ in 2D}
        \label{fig:lyapunov_derivative_r0_major_1_first}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Figure/lyapunov_derivative_3d_R0_major_1.png}  
        \caption{$\dot{V}$ in 3D}
        \label{fig:lyapunov_derivative_r0_major_1_second}
    \end{subfigure}
    \caption{$\dot{V}$ with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = \frac{1}{14}$, $P = 1$}
\end{figure}

\subsection{Bifurcation analsys}

First of all, it is important notice that, given \ref{eq:r0_definition} and given that $\beta$ and $\mu$ are intrinsic parameter that cannot be changed, and remembering that $R_0 = \frac{\beta}{\gamma + \mu}$, then

\begin{equation}
    R_0 = 1 \implies \gamma =  \beta - \mu
\end{equation}

As has been seen before, for $\gamma > \beta-\mu$ in $\Omega$ there is only one not endemic equilibrium point (node), while for $\gamma < \beta-\mu$ in $\Omega$ there are a not endemic equilibrium point (saddle point) and an endemic equilibrium point (stable focus or node). Actually, considering as domain not $\Omega$ but all $\mathbb{R}^2$ even to $R_0 < 1$ there is an endemic equilibrum point (saddle point).

Varing $\gamma < \beta-\mu$ happens that endemic equilibrium point (initially asymptotically stable) tend to became closer to not endemic equilibria (saddle point). At $\gamma = \beta-\mu$ there is a "crush" between them where stable manifold of endemic quilibria "changes" stability with unstable maniold of not endemic equilibrium point.
After this crush, for $\gamma > \beta-\mu$ endemic equilibrium point became a saddle point and go outside of $\Omega$, while not endemic equilibrium point became a stable node.

In Figure \ref{fig:bifurcation_s} and Figure \ref{fig:bifurcation_i} are rapresented variations of S e I:
\begin{itemize}
    \item dashed lines are associated with saddle point;
    \item continuous lines are associated with locally asymptotically stable point
\end{itemize}

\begin{figure}[h!]
    \label{fig:bifurcation}
    \begin{subfigure}{.5\textwidth}
        \centering
        % include first image
        \includegraphics[width=\linewidth]{Figure/bifurcation_s.png}  
        \caption{Bifurcation of S}
        \label{fig:bifurcation_s}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Figure/bifurcation_i.png}  
        \caption{Bifurcation of I}
        \label{fig:bifurcation_i}
    \end{subfigure}
    \caption{Bifurcation with parameters $\beta = 0.4$, $\mu = 0.2$,}
\end{figure}

\break
\input{Proofs/R0_equal_to_1_Bifurcation}

\subsection{Simulazioni}
Di seguito verranno riportate due simulazioni del modello SIR.

In Figure \ref{fig:sir_model_evolution_r0_minor_1} is rapresented the evolution of SIR model in case of $R_0 < 1$. It should be noted that Infected tends towards zero because sum of recovery rate and death rate are major then infection rate, so number of people that are infected are less then number of people that are healed by national healthcare system. Removed tends towards zero because birth rate is equal to death rate, so for each people that dies, onther one born in Susceptible.

\begin{figure}[h!]
    \centering
    \includegraphics[width=\linewidth]{Figure/SIR_evolution_r0_minor_1.png}
    \caption{Evolution of SIR model with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = 0.3$}
    \label{fig:sir_model_evolution_r0_minor_1}
\end{figure}

In Figure \ref{fig:sir_model_evolution_r0_major_1} is rapresented the evolution of SIR model in case of $R_0 > 1$. It should be noted that Infected tends towards a value different from zero, this because health care system cannot heal in time all infected, so national healthcare system saturates and a constant part of infected die for other causes.

\begin{figure}[h!]
    \centering
    \includegraphics[width=\linewidth]{Figure/SIR_evolution_r0_major_1.png}
    \caption{Evolution of SIR model with parameters $\beta = 0.4$, $\mu = 0.2$, $\gamma = \frac{1}{14}$}
    \label{fig:sir_model_evolution_r0_major_1}
\end{figure}